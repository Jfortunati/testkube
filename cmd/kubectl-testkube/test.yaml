apiVersion: tests.testkube.io/v3
kind: Test
metadata:
  name: postman-ai
  namespace: testkube
spec:
  type: postman/collection
  content:
    type: string
    data: "{\n    \"info\": {\n        \"_postman_id\": \"abcd1234-5678-efgh-ijkl-mnopqrstuvwx\",\n        \"name\": \"Smoke Test for Service in Kubernetes using Newman\",\n        \"description\": \"This collection is used to smoke test a service running in Kubernetes using Newman tool\",\n        \"schema\": \"https://schema.getpostman.com/json/collection/v2.1.0/collection.json\"\n    },\n    \"item\": [\n        {\n            \"name\": \"Health Check\",\n            \"event\": [\n                {\n                    \"listen\": \"test\",\n                    \"script\": {\n                        \"exec\": [\n                            \"pm.test(\\\"Status code is 200\\\", function () {\",\n                            \"    pm.response.to.have.status(200);\",\n                            \"});\",\n                            \"pm.test(\\\"Response time is less than 300ms\\\", function () {\",\n                            \"    pm.expect(pm.response.responseTime).to.be.below(300);\",\n                            \"});\"\n                        ]\n                    }\n                }\n            ],\n            \"request\": {\n                \"method\": \"GET\",\n                \"header\": [],\n                \"url\": {\n                    \"raw\": \"{{URI}}/health\",\n                    \"host\": [\n                        \"{{URI}}\"\n                    ],\n                    \"path\": [\n                        \"health\"\n                    ]\n                }\n            },\n            \"response\": []\n        },\n        {\n            \"name\": \"API Endpoint\",\n            \"event\": [\n                {\n                    \"listen\": \"test\",\n                    \"script\": {\n                        \"exec\": [\n                            \"pm.test(\\\"Status code is 200\\\", function () {\",\n                            \"    pm.response.to.have.status(200);\",\n                            \"});\",\n                            \"pm.test(\\\"Response time is less than 500ms\\\", function () {\",\n                            \"    pm.expect(pm.response.responseTime).to.be.below(500);\",\n                            \"});\"\n                        ]\n                    }\n                }\n            ],\n            \"request\": {\n                \"method\": \"GET\",\n                \"header\": [],\n                \"url\": {\n                    \"raw\": \"{{URI}}/api\",\n                    \"host\": [\n                        \"{{URI}}\"\n                    ],\n                    \"path\": [\n                        \"api\"\n                    ]\n                }\n            },\n            \"response\": []\n        }\n    ],\n    \"variable\": [\n        {\n            \"key\": \"URI\",\n            \"value\": \"https://testkube.io\",\n            \"type\": \"string\"\n        }\n    ]\n}"
